alias: Powerwall Mode Self-Powered
sequence:
  - service: number.set_value
    data:
      value: "10"
    target:
      entity_id: number.powerwall_cloud_backup_reserve
  - service: select.select_option
    data:
      option: Self-Powered
    target:
      entity_id: select.powerwall_cloud_operation_mode
  - service: select.select_option
    data:
      option: "No"
    target:
      entity_id: select.powerwall_cloud_grid_charging
  - service: select.select_option
    data:
      option: Solar
    target:
      entity_id: select.powerwall_cloud_energy_exports
  - if:
      - condition: not
        conditions:
          - condition: state
            entity_id: input_select.powerwall_battery_custom_modes
            state: Self-Powered
    then:
      - service: input_select.select_option
        data:
          option: Self-Powered
        target:
          entity_id: input_select.powerwall_battery_custom_modes
mode: single
